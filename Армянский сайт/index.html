<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Armenian Flavors - Кулинарный портал армянской кухни</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Шапка сайта -->
    <header class="header">
        <div class="container">
            <nav class="navbar">
                <a href="index.html" class="logo">
                    <i class="fas fa-utensils"></i>
                    <span>Armenian Flavors</span>
                </a>
                
                <div class="nav-menu">
                    <a href="index.html" class="nav-link active">Главная</a>
                    <a href="pages/catalog.html" class="nav-link">Каталог рецептов</a>
                    <a href="pages/add-recipe.html" class="nav-link">Добавить рецепт</a>
                    <a href="pages/about.html" class="nav-link">О нас</a>
                </div>
                
                <div class="nav-actions">
                    <a href="pages/auth.html" class="btn btn-outline" id="authBtn">
                        <i class="fas fa-user"></i>
                        <span>Войти</span>
                    </a>
                    <a href="pages/profile.html" class="btn btn-primary hidden" id="profileBtn">
                        <i class="fas fa-user-circle"></i>
                        <span>Профиль</span>
                    </a>
                </div>
                
                <button class="menu-toggle" id="menuToggle">
                    <i class="fas fa-bars"></i>
                </button>
            </nav>
        </div>
    </header>

    <!-- Слайдер популярных рецептов -->
    <section class="hero-slider">
        <div class="container">
            <h1 class="hero-title">Армянская кухня: вкус тысячелетий</h1>
            <div class="slider">
                <div class="slide active">
                    <div class="slide-content">
                        <h2>Долма</h2>
                        <p>Традиционное блюдо из виноградных листьев</p>
                        <a href="pages/recipe.html?id=6" class="btn btn-primary">Смотреть рецепт</a>
                    </div>
                </div>
                <div class="slide">
                    <div class="slide-content">
                        <h2>Хоровац</h2>
                        <p>Армянский шашлык на углях</p>
                        <a href="pages/recipe.html?id=7" class="btn btn-primary">Смотреть рецепт</a>
                    </div>
                </div>
                <div class="slide">
                    <div class="slide-content">
                        <h2>Гата</h2>
                        <p>Традиционная армянская выпечка</p>
                        <a href="pages/recipe.html?id=17" class="btn btn-primary">Смотреть рецепт</a>
                    </div>
                </div>
            </div>
            <div class="slider-controls">
                <button class="slider-btn prev" id="prevSlide">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="slider-btn next" id="nextSlide">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </section>

    <!-- Основное содержимое -->
    <main class="container">
        <!-- Категории блюд -->
        <section class="categories">
            <h2 class="section-title">Категории блюд</h2>
            <div class="categories-grid">
                <a href="pages/catalog.html#category-1" class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-utensil-spoon"></i>
                    </div>
                    <h3>Супы</h3>
                    <p>Традиционные армянские супы</p>
                </a>
                <a href="pages/catalog.html#category-2" class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-drumstick-bite"></i>
                    </div>
                    <h3>Основные блюда</h3>
                    <p>Мясные и овощные блюда</p>
                </a>
                <a href="pages/catalog.html#category-3" class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-bread-slice"></i>
                    </div>
                    <h3>Выпечка</h3>
                    <p>Хлеб, лаваш, гата</p>
                </a>
                <a href="pages/catalog.html#category-4" class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-cheese"></i>
                    </div>
                    <h3>Закуски</h3>
                    <p>Салаты и холодные закуски</p>
                </a>
                <a href="pages/catalog.html#category-5" class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-ice-cream"></i>
                    </div>
                    <h3>Десерты</h3>
                    <p>Сладости и выпечка</p>
                </a>
                <a href="pages/catalog.html#category-6" class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-glass-whiskey"></i>
                    </div>
                    <h3>Напитки</h3>
                    <p>Традиционные напитки</p>
                </a>
            </div>
        </section>

        <!-- Популярные рецепты -->
        <section class="popular-recipes">
            <div class="section-header">
                <h2 class="section-title">Популярные рецепты</h2>
                <a href="pages/catalog.html" class="view-all">Смотреть все →</a>
            </div>
            <div class="recipes-grid" id="popularRecipes">
                <!-- Рецепты будут загружены через JavaScript -->
            </div>
        </section>

        <!-- Информация о проекте -->
        <section class="about-preview">
            <div class="about-content">
                <h2>О проекте Armenian Flavors</h2>
                <p>Наш портал посвящен сохранению и популяризации богатых кулинарных традиций Армении. Мы собираем как классические, так и современные рецепты, адаптированные для приготовления в домашних условиях.</p>
                <a href="pages/about.html" class="btn btn-primary">Узнать больше</a>
            </div>
            <div class="about-image">
                <i class="fas fa-utensils fa-5x"></i>
            </div>
        </section>
        
        <!-- Преимущества платформы -->
        <section class="features">
            <h2 class="section-title">Почему выбирают Armenian Flavors?</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-book"></i>
                    </div>
                    <h3>Богатая коллекция</h3>
                    <p>Более 40 проверенных рецептов армянской кухни</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <h3>Сообщество</h3>
                    <p>Кулинары делятся опытом и семейными рецептами</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-mobile-alt"></i>
                    </div>
                    <h3>Удобный доступ</h3>
                    <p>Адаптивный дизайн для всех устройств</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3>Проверенные рецепты</h3>
                    <p>Все рецепты соответствуют традициям армянской кухни</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Подвал -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Armenian Flavors</h3>
                    <p>Кулинарный портал армянской кухни</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-vk"></i></a>
                        <a href="#"><i class="fab fa-telegram"></i></a>
                    </div>
                </div>
                <div class="footer-section">
                    <h4>Разделы</h4>
                    <a href="index.html">Главная</a>
                    <a href="pages/catalog.html">Каталог рецептов</a>
                    <a href="pages/add-recipe.html">Добавить рецепт</a>
                    <a href="pages/about.html">О нас</a>
                </div>
                <div class="footer-section">
                    <h4>Помощь</h4>
                    <a href="#">FAQ</a>
                    <a href="#">Контакты</a>
                    <a href="#">Правила сайта</a>
                </div>
                <div class="footer-section">
                    <h4>Контакты</h4>
                    <p><i class="fas fa-envelope"></i> info@armenianflavors.com</p>
                    <p><i class="fas fa-phone"></i> +7 (XXX) XXX-XX-XX</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Armenian Flavors. Все права защищены.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script src="indexedDB.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            // Инициализация слайдера
            initSlider();
            
            // Инициализация мобильного меню
            initMobileMenu();
            
            // Проверка авторизации
            checkAuth();
            
            // Загрузка популярных рецептов
            await loadPopularRecipes();
        });
        
        // Инициализация слайдера
        function initSlider() {
            const slides = document.querySelectorAll('.slide');
            const prevBtn = document.getElementById('prevSlide');
            const nextBtn = document.getElementById('nextSlide');
            let currentSlide = 0;
            
            if (!slides.length) return;
            
            function showSlide(index) {
                slides.forEach(slide => slide.classList.remove('active'));
                currentSlide = (index + slides.length) % slides.length;
                slides[currentSlide].classList.add('active');
            }
            
            if (prevBtn) {
                prevBtn.addEventListener('click', () => showSlide(currentSlide - 1));
            }
            
            if (nextBtn) {
                nextBtn.addEventListener('click', () => showSlide(currentSlide + 1));
            }
            
            // Автопрокрутка слайдера
            setInterval(() => showSlide(currentSlide + 1), 5000);
        }
        
        // Инициализация мобильного меню
        function initMobileMenu() {
            const menuToggle = document.getElementById('menuToggle');
            const navMenu = document.querySelector('.nav-menu');
            
            if (menuToggle && navMenu) {
                menuToggle.addEventListener('click', () => {
                    navMenu.classList.toggle('active');
                    menuToggle.innerHTML = navMenu.classList.contains('active') 
                        ? '<i class="fas fa-times"></i>' 
                        : '<i class="fas fa-bars"></i>';
                });
            }
        }
        
        // Функция проверки авторизации
        function checkAuth() {
            const authBtn = document.getElementById('authBtn');
            const profileBtn = document.getElementById('profileBtn');
            const user = window.db?.getCurrentUser?.();
            
            if (user) {
                authBtn?.classList.add('hidden');
                profileBtn?.classList.remove('hidden');
                profileBtn.querySelector('span').textContent = user.login;
            } else {
                authBtn?.classList.remove('hidden');
                profileBtn?.classList.add('hidden');
            }
        }
        
        // Функция для получения названия категории
        async function getCategoryName(id) {
            const category = await window.db?.getCategoryById?.(id);
            return category?.name || 'Неизвестно';
        }
        
        // Загрузка популярных рецептов
        async function loadPopularRecipes() {
            const recipesGrid = document.getElementById('popularRecipes');
            if (!recipesGrid) return;
            
            try {
                const popularRecipes = await window.db?.getPopularRecipes?.(6) || [];
                
                if (popularRecipes.length === 0) {
                    recipesGrid.innerHTML = '<p>Пока нет рецептов</p>';
                    return;
                }
                
                recipesGrid.innerHTML = await Promise.all(popularRecipes.map(async recipe => {
                    const categoryName = await getCategoryName(recipe.categoryId);
                    
                    return `
                        <div class="recipe-card">
                            <div class="recipe-image">
                                <i class="fas fa-utensils fa-3x"></i>
                            </div>
                            <div class="recipe-content">
                                <div class="recipe-category">${categoryName}</div>
                                <h3 class="recipe-title">${recipe.title}</h3>
                                <div class="recipe-meta">
                                    <span><i class="fas fa-clock"></i> ${recipe.cookingTime} мин</span>
                                    <span><i class="fas fa-signal"></i> ${recipe.difficulty}</span>
                                </div>
                                <p class="recipe-description">${recipe.description}</p>
                                <div class="recipe-footer">
                                    <div class="recipe-rating">
                                        <i class="fas fa-star"></i>
                                        <span>${recipe.rating?.toFixed(1) || '4.5'}</span>
                                    </div>
                                    <a href="pages/recipe.html?id=${recipe.id}" class="btn btn-primary">
                                        <i class="fas fa-book-open"></i>
                                        <span>Открыть</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    `;
                })).then(html => html.join(''));
            } catch (error) {
                console.error('Ошибка загрузки популярных рецептов:', error);
                recipesGrid.innerHTML = '<p>Ошибка загрузки рецептов</p>';
            }
        }
    </script>
</body>
</html>